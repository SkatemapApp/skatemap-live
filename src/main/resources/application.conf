play.modules.enabled += "skatemap.infra.SkatemapLiveModule"

play.http.errorHandler = "play.api.http.JsonHttpErrorHandler"

play.filters.hosts.allowed = [".up.railway.app", "healthcheck.railway.app", "localhost"]

play.server.http.port = 9000
play.server.http.port = ${?PORT}

skatemap {
  cleanup {
    initialDelaySeconds = 10
    initialDelaySeconds = ${?CLEANUP_INITIAL_DELAY_SECONDS}
    intervalSeconds = 10
    intervalSeconds = ${?CLEANUP_INTERVAL_SECONDS}
  }
  location {
    ttlSeconds = 30
    ttlSeconds = ${?LOCATION_TTL_SECONDS}
  }
  stream {
    batchSize = 100
    batchSize = ${?STREAM_BATCH_SIZE}
    batchIntervalMillis = 500
    batchIntervalMillis = ${?STREAM_BATCH_INTERVAL_MILLIS}
  }
  hub {
    # Time-to-live for unused broadcast hubs (5 minutes)
    # Hubs that have not been accessed (published to or subscribed) for this duration will be removed
    ttlSeconds = 300
    ttlSeconds = ${?HUB_TTL_SECONDS}

    # Cleanup interval (1 minute)
    # How often the cleanup process runs to remove unused hubs
    # Should be less than ttlSeconds to ensure timely cleanup
    cleanupIntervalSeconds = 60
    cleanupIntervalSeconds = ${?HUB_CLEANUP_INTERVAL_SECONDS}

    # Buffer size for WebSocket broadcast hubs
    # Number of messages to buffer per hub
    # Higher values provide more resilience to slow consumers but use more memory
    bufferSize = 128
    bufferSize = ${?HUB_BUFFER_SIZE}
  }
}
